# Question 8:

What is the trend of net revenue and orders by quarters? [4 marks]
> Hint: Find out the sum of net revenue and count the number of orders for each quarter.

---

## Solution

2 options
1. Normal query
2. Optimized via CTE

### Option 1 (Repeatation | Less Readable ❌)

```sql
SELECT
    quarter_number,
    COUNT(*) as order_count,
    ROUND(SUM(quantity * vehicle_price * (1 - discount/100)), 2) as net_revenue,
    ROUND(SUM(quantity * vehicle_price * (1 - discount/100))/COUNT(*), 2) as avg_revenue_per_order
FROM order_t
GROUP BY quarter_number
ORDER BY quarter_number;
```

### Option 2 (CTE | More Redable ✅)

```sql
WITH computed_orders AS (
    SELECT
        quarter_number,
        quantity * vehicle_price * (1 - discount / 100) AS net_revenue_per_order
    FROM order_t
)
SELECT
    quarter_number,
    COUNT(*) AS order_count,
    ROUND(SUM(net_revenue_per_order), 2) AS net_revenue,
    ROUND(SUM(net_revenue_per_order) / COUNT(*), 2) AS avg_revenue_per_order
FROM computed_orders
GROUP BY quarter_number
ORDER BY quarter_number;
```


**Result**
```
| Quarter Number | Order Count | Net Revenue    | Avg Revenue per Order |
|----------------|-------------|----------------|------------------------|
| 1              | 310         | 39,421,580.16  | 127,166.39             |
| 2              | 262         | 32,715,830.34  | 124,869.58             |
| 3              | 229         | 29,229,896.19  | 127,641.47             |
| 4              | 199         | 23,346,779.63  | 117,320.50             |
```

---

## Observations / Insights

1. Parallel decline in both orders and revenue:
   - Orders: 310 → 199 (⬇️ 36%)
   - Revenue: $39.4M → $23.3M (⬇️ 41%)

2. Average revenue per order remained relatively stable Q1-Q3:
   - Fluctuated around ~$127K
   - Sharp drop in Q4 to $117K (⬇️ 8%)

3. Critical Q4 insights:
   - Not just fewer orders, but lower value orders
   - Suggests losing both volume AND high-value customers
   - Compound effect leading to steepest revenue decline

**Insights**

1. Quarter 1 had the highest revenue and most orders ie peak business period.
2. While order volume decreased each quarter, the average revenue per order remained fairly consistent (except for Q4).
3. Quarter 4 saw the lowest net revenue and average revenue per order, indicating potential issues with customer engagement or pricing.

🧠 Noteworthy Observations

- Despite Q3 having fewer orders than Q2, it had slightly higher avg revenue per order, showing improved per-order sales efficiency.
- Monitoring average revenue per order can help detect discount impact or pricing strategy effectiveness over time.

> This combined view reveals that Q4's revenue drop was driven by both decreased order volume and lower order values.